<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Ensure responsive behavior and optimize for mobile screen sizes -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Night Clock</title>
    
    <!-- PWA MANIFEST METADATA (Replaces manifest.json) -->
    <!-- The "standalone" mode triggers the app-like fullscreen display -->
    <meta name="application-name" content="DigiClock">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">

    <!-- Embedded Icon (Simple Digital Watch SVG, Base64 Encoded) -->
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4gPHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzAwMDAwMCIvPiA8cmVjdCB4PSIxMjAiIHk9IjIwMCIgd2lkdGg9IjI3MiIgaGVpZ2h0PSIxMTIiIGZpbGw9IiM4MDgwODAiLz4gPHRleHQgeD0iMjU2IiB5PSIyNzAiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiIGZvbnQtc2l6ZT0iNDgiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiPjAwOjAwPC90ZXh0PiA8L3N2Zz4=" sizes="512x512">
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind to use Inter font and define the custom segmented font -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        // Define a font stack for the new 7-segment look
                        'seven-segment': ['DS-Digital', 'Segment Seven', 'monospace'], 
                    },
                    colors: {
                        'primary-gray': '#808080', // Requested color for time and date
                        'setting-accent': '#C0C0C0', // Light gray accent for settings button/modal
                    },
                }
            }
        }
    </script>
    <style>
        /* Define the DS-Digital font face for the authentic 7-segment appearance */
        @font-face {
            font-family: 'DS-Digital';
            /* Using a reliable true type source for the digital font */
            src: url('https://raw.githubusercontent.com/l-demin/ds-digital/master/ds-digital.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        /* Custom style for the subtle setting button glow */
        .settings-accent-style {
            box-shadow: 0 0 5px rgba(192, 192, 192, 0.5);
            transition: all 0.2s ease-in-out;
        }
        .settings-accent-style:hover {
            box-shadow: 0 0 8px rgba(192, 192, 192, 0.8);
        }

        /* Set the body and HTML to full viewport height and solid black background */
        html, body {
            height: 100%;
            overflow: hidden; /* Prevent scrolling */
        }

        /* Modal Styles */
        .modal {
            z-index: 100;
            background-color: rgba(0, 0, 0, 0.9); /* Darker overlay */
        }
        .modal-content {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Custom slider track and thumb styling for a dark theme */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #444;
            border-radius: 4px;
            outline: none;
            margin: 10px 0;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #C0C0C0; /* setting-accent */
            cursor: pointer;
            box-shadow: 0 0 4px #C0C0C0;
        }

    </style>
</head>
<!-- Default font for body is now Inter (font-sans) -->
<body class="bg-black font-sans flex flex-col justify-center items-center h-full w-full p-4 relative">

    <!-- Settings Button (Top Right Corner) -->
    <button id="settings-button" onclick="showSettingsModal()" 
            class="absolute top-4 right-4 p-3 bg-gray-900 rounded-full border border-setting-accent text-setting-accent settings-accent-style transition duration-300">
        <!-- Gear Icon (SVG) -->
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
            <path fill-rule="evenodd" d="M11.078 2.275a.75.75 0 0 1 .844 0 12.75 12.75 0 0 0 8.661 2.946.75.75 0 0 1 .632.42.75.75 0 0 1-.035.895l-1.922 2.766c-.662.956-.342 2.217.79 2.571l1.792.57a.75.75 0 0 1 .453.693c0 .878-.445 1.636-1.002 2.149l-1.42 1.343a.75.75 0 0 1-.947.079l-1.745-.968a.75.75 0 0 0-.966.195l-1.353 2.115a.75.75 0 0 1-.774.269 13.5 13.5 0 0 1-5.18 0 .75.75 0 0 1-.774-.269L5.32 17.653a.75.75 0 0 0-.966-.195l-1.745.968a.75.75 0 0 1-.947-.079l-1.42-1.343c-.557-.513-1.002-1.271-1.002-2.149a.75.75 0 0 1 .453-.693l1.792-.57c1.132-.354 1.452-1.615.79-2.571L3.582 6.536a.75.75 0 0 1-.035-.895.75.75 0 0 1 .632-.42 12.75 12.75 0 0 0 8.661-2.946ZM12 16.5a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9Z" clip-rule="evenodd" />
        </svg>
    </button>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal fixed inset-0 flex items-center justify-center hidden" onclick="if(event.target.id === 'settings-modal') hideSettingsModal(false)">
        <div class="modal-content bg-gray-900 p-8 rounded-xl shadow-2xl w-full max-w-sm border border-primary-gray">
            <h2 class="text-setting-accent text-2xl font-bold mb-6 font-sans border-b border-gray-700 pb-2">Clock Settings</h2>
            
            <div class="space-y-6">

                <!-- Display Size Section (SLIDERS) -->
                <div class="border-b border-gray-700 pb-4">
                    <h3 class="text-gray-400 font-bold mb-2">Display Size:</h3>
                    
                    <!-- Time Size Slider -->
                    <div class="mb-4">
                        <label for="time-size-slider" class="block text-gray-300 mb-1 font-sans text-sm flex justify-between">
                            Time Size (VW): <span id="time-size-value" class="text-setting-accent"></span>
                        </label>
                        <input type="range" id="time-size-slider" min="25" max="250" step="25"
                                oninput="updateSliderValue('time')"
                                class="w-full">
                    </div>

                    <!-- Date Size Slider -->
                    <div>
                        <label for="date-size-slider" class="block text-gray-300 mb-1 font-sans text-sm flex justify-between">
                            Date Size (REM): <span id="date-size-value" class="text-setting-accent"></span>
                        </label>
                        <input type="range" id="date-size-slider" min="25" max="250" step="25"
                                oninput="updateSliderValue('date')"
                                class="w-full">
                    </div>
                </div>
                
                <!-- Time Format Section -->
                <div class="border-b border-gray-700 pb-4">
                    <h3 class="text-gray-400 font-bold mb-2">Time Format:</h3>
                    <div id="time-format-options" class="space-y-3 text-gray-400">
                        <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg border border-gray-700 hover:bg-gray-800">
                            <input type="radio" name="timeFormat" value="24h" id="time-24h"
                                   class="h-5 w-5 text-primary-gray form-radio bg-gray-900 border-gray-600 focus:ring-primary-gray">
                            <span class="text-gray-300 font-sans text-sm">24-Hour (e.g., 14:30:00)</span>
                        </label>
                        <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg border border-gray-700 hover:bg-gray-800">
                            <input type="radio" name="timeFormat" value="12h" id="time-12h"
                                   class="h-5 w-5 text-primary-gray form-radio bg-gray-900 border-gray-600 focus:ring-primary-gray">
                            <span class="text-gray-300 font-sans text-sm">12-Hour (e.g., 02:30:00 PM)</span>
                        </label>
                    </div>
                </div>

                <!-- Date Format Section -->
                <div>
                    <h3 class="text-gray-400 font-bold mb-2">Date Format:</h3>
                    <div id="date-format-options" class="space-y-3 text-gray-400">
                        <!-- Date format radios will be populated here by JS -->
                    </div>
                </div>

            </div>

            <div class="flex justify-end space-x-4 mt-8">
                <button onclick="hideSettingsModal(false)" 
                        class="px-4 py-2 text-gray-400 bg-gray-700 rounded-lg hover:bg-gray-600 transition">
                    Cancel
                </button>
                <button onclick="saveSettings()" 
                        class="px-4 py-2 text-gray-900 font-bold bg-setting-accent rounded-lg hover:bg-gray-400 transition">
                    Save Changes
                </button>
            </div>
        </div>
    </div>


    <!-- Main Clock Display Container -->
    <div id="clock-container" class="text-center p-4 pt-16">
        <!-- Time display uses the 7-segment font -->
        <div id="time-display" class="font-seven-segment font-bold tracking-tight select-none transition-opacity duration-300 text-primary-gray">
            --:--:--
        </div>
        <!-- Date display remains standard font (Inter) -->
        <div id="date-display" class="text-primary-gray mt-4 tracking-wider opacity-75">
            Loading Date...
        </div>
    </div>

    <!-- JavaScript for Clock Logic -->
    <script>
        // --- DOM Elements ---
        const timeDisplay = document.getElementById('time-display');
        const dateDisplay = document.getElementById('date-display');
        const settingsModal = document.getElementById('settings-modal');
        const dateFormatOptionsDiv = document.getElementById('date-format-options');

        let currentSeconds = -1; 
        
        // --- Load Preferences from LocalStorage ---
        let timeFormatPreference = localStorage.getItem('timeFormat') || '24h';
        let dateFormatPreference = localStorage.getItem('dateFormat') || 'Full';
        
        // Load numerical font sizes
        let timeFontSize = parseInt(localStorage.getItem('timeFontSize')) || 150; 
        let dateFontSize = parseInt(localStorage.getItem('dateFontSize')) || 200; 

        // --- Constants for Size Sliders and Scaling ---
        const MIN_SLIDER = 25; 
        const MAX_SLIDER = 250;
        const STEP_SLIDER = 25;
        const TIME_VW_SCALE = 10; // Max 250 -> 25.0vw
        const DATE_REM_SCALE = 100; // Max 250 -> 2.5rem (0.25rem steps)

        // --- Setting Definitions ---
        const DATE_FORMATS = {
            'Full': { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', label: 'Full Text (e.g., Tuesday, Oct 14, 2025)' },
            'US': { month: '2-digit', day: '2-digit', year: 'numeric', label: 'Short US (e.g., 10/14/2025)' },
            'Intl': { day: '2-digit', month: '2-digit', year: 'numeric', label: 'Short Intl (e.g., 14/10/2025)' },
            'Custom': { label: 'Custom Format (e.g., Tuesday / 14 / October / 25)' }
        };

        // --- Settings Modal Logic ---

        // Function to show the live slider value
        function updateSliderValue(type) {
            if (type === 'time') {
                const value = document.getElementById('time-size-slider').value;
                document.getElementById('time-size-value').textContent = `${value} (${(value / TIME_VW_SCALE).toFixed(1)}vw)`;
            } else if (type === 'date') {
                const value = document.getElementById('date-size-slider').value;
                // Calculate REM value and format to two decimal places (ensures 0.25 steps are clear)
                const rem = Math.max(0.25, value / DATE_REM_SCALE); 
                document.getElementById('date-size-value').textContent = `${value} (${rem.toFixed(2)}rem)`;
            }
        }

        function populateSettingsModal() {
            // 1. Populate Date Format Options
            let dateHtml = '';
            for (const key in DATE_FORMATS) {
                const format = DATE_FORMATS[key];
                const isChecked = key === dateFormatPreference;
                dateHtml += `
                    <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg border border-gray-700 hover:bg-gray-800">
                        <input type="radio" name="dateFormat" value="${key}" ${isChecked ? 'checked' : ''}
                               class="h-5 w-5 text-primary-gray form-radio bg-gray-900 border-gray-600 focus:ring-primary-gray">
                        <span class="text-gray-300 font-sans text-sm">${format.label}</span>
                    </label>
                `;
            }
            dateFormatOptionsDiv.innerHTML = dateHtml;

            // 2. Set Time Format Radios
            document.getElementById('time-24h').checked = timeFormatPreference === '24h';
            document.getElementById('time-12h').checked = timeFormatPreference === '12h';

            // 3. Set Display Size Sliders
            document.getElementById('time-size-slider').value = timeFontSize;
            document.getElementById('date-size-slider').value = dateFontSize;
            
            // Update initial displayed values next to sliders
            updateSliderValue('time');
            updateSliderValue('date');
        }

        function showSettingsModal() {
            populateSettingsModal();
            settingsModal.classList.remove('hidden');
        }

        function hideSettingsModal(shouldRefresh = false) {
            settingsModal.classList.add('hidden');
            if (shouldRefresh) {
                updateTime(); 
                applySizeClasses(); // Apply new size instantly
            }
        }

        function saveSettings() {
            // Save Date Format
            const selectedDateFormat = document.querySelector('input[name="dateFormat"]:checked')?.value;
            if (selectedDateFormat && DATE_FORMATS[selectedDateFormat]) {
                dateFormatPreference = selectedDateFormat;
                localStorage.setItem('dateFormat', selectedDateFormat);
            }

            // Save Time Format
            const selectedTimeFormat = document.querySelector('input[name="timeFormat"]:checked')?.value;
            if (selectedTimeFormat && (selectedTimeFormat === '24h' || selectedTimeFormat === '12h')) {
                timeFormatPreference = selectedTimeFormat;
                localStorage.setItem('timeFormat', selectedTimeFormat);
            }

            // Save Display Sizes
            const newTimeSize = document.getElementById('time-size-slider').value;
            const newDateSize = document.getElementById('date-size-slider').value;

            timeFontSize = parseInt(newTimeSize);
            dateFontSize = parseInt(newDateSize);
            localStorage.setItem('timeFontSize', timeFontSize);
            localStorage.setItem('dateFontSize', dateFontSize);

            hideSettingsModal(true); // Save and refresh
        }

        // Function to apply the correct size classes based on preference
        function applySizeClasses() {
            // 1. Calculate and apply Time size (in vw)
            const timeVW = timeFontSize / TIME_VW_SCALE;
            timeDisplay.style.fontSize = `${timeVW}vw`;
            
            // 2. Calculate and apply Date size (in rem)
            const dateRem = Math.max(0.25, dateFontSize / DATE_REM_SCALE);
            dateDisplay.style.fontSize = `${dateRem}rem`;
        }

        // --- Clock Logic ---
        function updateTime() {
            const now = new Date();

            const newSeconds = now.getSeconds();
            if (newSeconds === currentSeconds) {
                return;
            }
            currentSeconds = newSeconds;

            // 1. Time Formatting (Based on preference)
            const hour12 = timeFormatPreference === '12h';
            const timeOptions = {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: hour12
            };
            
            const timeString = now.toLocaleTimeString('en-US', timeOptions);
            timeDisplay.textContent = timeString;

            // 2. Date Formatting (Based on preference)
            let dateString;
            
            if (dateFormatPreference === 'US' || dateFormatPreference === 'Intl') {
                const day = now.getDate().toString().padStart(2, '0');
                const month = (now.getMonth() + 1).toString().padStart(2, '0');
                const year = now.getFullYear();

                if (dateFormatPreference === 'US') {
                    dateString = `${month}/${day}/${year}`;
                } else { // 'Intl'
                    dateString = `${day}/${month}/${year}`;
                }
            } else if (dateFormatPreference === 'Custom') {
                // Custom format: Full day name / day / full month name / 2 last numbers of the year
                const fullDayName = now.toLocaleDateString('en-US', { weekday: 'long' });
                const day = now.getDate().toString().padStart(2, '0');
                const fullMonthName = now.toLocaleDateString('en-US', { month: 'long' });
                const yearShort = now.getFullYear().toString().slice(-2); 
                
                dateString = `${fullDayName} / ${day} / ${fullMonthName} / ${yearShort}`;
            }
            else {
                 // 'Full' format
                 const formatOptions = DATE_FORMATS['Full'];
                dateString = now.toLocaleDateString('en-US', formatOptions);
            }

            dateDisplay.textContent = dateString;

            // Subtle blink effect for the seconds
            if (newSeconds % 2 === 0) {
                timeDisplay.classList.remove('opacity-90');
                timeDisplay.classList.add('opacity-100');
            } else {
                timeDisplay.classList.remove('opacity-100');
                timeDisplay.classList.add('opacity-90');
            }
        }

        // Initial setup and start loop
        applySizeClasses();
        updateTime();
        setInterval(updateTime, 100);

    </script>

</body>
</html>

      
